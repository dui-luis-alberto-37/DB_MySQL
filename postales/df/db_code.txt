CREATE DATABASE IF NOT EXISTS Postals;
USE Postals;

CREATE TABLE cod_post (
    d_codigo INT,
    d_asenta VARCHAR(60),
    d_tipo_asenta VARCHAR(60),
    D_mnpio VARCHAR(60),
    d_estado VARCHAR(60),
    d_ciudad VARCHAR(60),
    d_CP INT,
    c_estado INT,
    c_oficina INT,
    c_CP FLOAT,
    c_tipo_asenta INT,
    c_mnpio INT,
    id_asenta_cpcons INT,
    d_zona VARCHAR(60),
    c_cve_ciudad FLOAT
);

LOAD DATA LOCAL INFILE '/var/lib/mysql-files/clean_df.txt'
INTO TABLE cod_post
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
(
    d_codigo,
    d_asenta,
    d_tipo_asenta,
    D_mnpio,
    d_estado,
    d_ciudad,
    d_CP,
    c_estado,
    c_oficina,
    c_CP,
    c_tipo_asenta,
    c_mnpio,
    id_asenta_cpcons,
    d_zona,
    c_cve_ciudad
);

SELECT COUNT(DISTINCT d_ciudad) AS ciudad_unique_vals FROM cod_post;

SELECT MAX(d_CP) AS CP_max_val, MIN(d_CP) AS CP_min_val FROM cod_post;

SELECT DISTINCT d_asenta FROM cod_post WHERE d_asenta LIKE '%Maria%';

SELECT d_zona, COUNT(*) AS total FROM cod_post WHERE d_zona IN ('Rural', 'Urbano') GROUP BY d_zona;

